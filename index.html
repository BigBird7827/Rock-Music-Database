<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Artists</title>
  <style>
    :root{
      --bg0:#07070a;
      --bg1:#101018;
      --panel:rgba(255,255,255,.06);
      --detailBg:#12113d;
      --panel2:rgba(255,255,255,.09);
      --stroke:rgba(255,255,255,.14);
      --text:#f2f2f7;
      --muted:rgba(242,242,247,.72);
      --red:#ff355e;
      --blue:#3aa0ff;
      --green:#2cff9a;
      --yellow:#ffe44d;
      --shadow:0 18px 60px rgba(0,0,0,.55);
      --radius:18px;
      --radius2:24px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      color:var(--text);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      background:
        radial-gradient(1000px 600px at 18% 12%, rgba(58,160,255,.14), transparent 60%),
        radial-gradient(900px 520px at 82% 16%, rgba(255,228,77,.12), transparent 62%),
        radial-gradient(900px 520px at 70% 82%, rgba(44,255,154,.10), transparent 60%),
        radial-gradient(900px 520px at 20% 84%, rgba(255,53,94,.12), transparent 62%),
        linear-gradient(180deg, var(--bg0), var(--bg1));
      overflow:hidden;
    }

    .wrap{
      height:100%;
      display:grid;
      grid-template-rows:auto 1fr;
    }

    header{
      padding:18px 18px 12px;
      border-bottom:1px solid rgba(255,255,255,.10);
      background: linear-gradient(180deg, rgba(0,0,0,.35), rgba(0,0,0,0));
      backdrop-filter: blur(10px);
    }

    .top{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:14px;
      max-width:1200px;
      margin:0 auto;
    }

    .brand{
      display:flex;
      align-items:center;
      gap:14px;
      min-width:280px;
    }

    .logo{
      width:44px;
      height:44px;
      border-radius:14px;
      background:
        linear-gradient(135deg, rgba(255,53,94,.95), rgba(58,160,255,.95)),
        radial-gradient(20px 20px at 30% 30%, rgba(255,255,255,.45), transparent 55%);
      box-shadow: 0 18px 45px rgba(0,0,0,.55), 0 0 0 1px rgba(255,255,255,.14) inset;
      position:relative;
      overflow:hidden;
    }
    .logo:before{
      content:"";
      position:absolute;
      inset:-35%;
      background: repeating-linear-gradient(90deg, rgba(255,255,255,.18) 0 8px, transparent 8px 18px);
      transform: rotate(12deg);
      opacity:.35;
    }

    h1{
      margin:0;
      font-size:22px;
      letter-spacing:.6px;
      line-height:1.1;
      font-weight:800;
      background: linear-gradient(90deg, var(--yellow), var(--red), var(--blue), var(--green));
      -webkit-background-clip:text;
      background-clip:text;
      color:transparent;
      text-shadow: 0 6px 30px rgba(0,0,0,.45);
    }

    .tag{
      margin-top:3px;
      font-size:13px;
      color:var(--muted);
      letter-spacing:.2px;
    }

    .controls{
      display:flex;
      align-items:center;
      gap:10px;
      flex-wrap:wrap;
      justify-content:flex-end;
    }

    .pill{
      display:flex;
      align-items:center;
      gap:10px;
      padding:10px 12px;
      border-radius:999px;
      background:rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.12);
      box-shadow: 0 10px 30px rgba(0,0,0,.35);
    }

    input[type="search"]{
      width:min(420px, 52vw);
      appearance:none;
      border:none;
      outline:none;
      background:transparent;
      color:var(--text);
      font-size:14px;
      letter-spacing:.2px;
    }
    input[type="search"]::placeholder{color:rgba(242,242,247,.55)}

    select{
      appearance:none;
      border:none;
      outline:none;
      background:transparent;
      color:var(--text);
      font-size:13px;
      letter-spacing:.2px;
      padding-right:18px;
      cursor:pointer;
    }
    .selectWrap{
      position:relative;
      padding-right:6px;
    }
    .selectWrap:after{
      content:"â–¾";
      position:absolute;
      right:2px;
      top:50%;
      transform:translateY(-50%);
      color:rgba(242,242,247,.70);
      font-size:12px;
      pointer-events:none;
    }

    main{
      max-width:1200px;
      width:100%;
      margin:0 auto;
      padding:14px 18px 18px;
      display:grid;
      grid-template-columns: 420px 1fr;
      gap:14px;
      height:100%;
      min-height:0;
    }

    .panel{
      background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.05));
      border:1px solid rgba(255,255,255,.12);
      border-radius:var(--radius2);
      box-shadow: var(--shadow);
      overflow:hidden;
      min-height:0;
    }    section.panel:nth-of-type(2){
      background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.06)), var(--detailBg);
    }


    .listHeader{
      padding:14px 14px 12px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      border-bottom:1px solid rgba(255,255,255,.10);
      background: linear-gradient(180deg, rgba(0,0,0,.28), rgba(0,0,0,0));
    }

    .count{
      font-size:12px;
      color:rgba(242,242,247,.72);
      letter-spacing:.35px;
    }

    .spark{
      display:flex;
      gap:6px;
      align-items:flex-end;
      height:18px;
    }
    .bar{
      width:4px;
      border-radius:10px;
      background: linear-gradient(180deg, var(--yellow), var(--red));
      opacity:.9;
      animation: bounce 1.2s infinite ease-in-out;
      box-shadow: 0 10px 26px rgba(255,53,94,.22);
    }
    .bar:nth-child(2){background: linear-gradient(180deg, var(--green), var(--blue)); animation-delay:.12s}
    .bar:nth-child(3){background: linear-gradient(180deg, var(--blue), var(--yellow)); animation-delay:.24s}
    .bar:nth-child(4){background: linear-gradient(180deg, var(--red), var(--green)); animation-delay:.36s}
    @keyframes bounce{
      0%,100%{height:6px; opacity:.65}
      50%{height:18px; opacity:1}
    }

    .list{
      height:100%;
      overflow:auto;
      padding:10px;
    }

    .item{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      padding:10px 12px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.18);
      cursor:pointer;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
      margin-bottom:8px;
    }
    .item:hover{
      transform: translateY(-1px);
      background: rgba(255,255,255,.06);
      border-color: rgba(255,255,255,.18);
    }
    .item.active{
      background:
        radial-gradient(400px 120px at 20% 20%, rgba(255,228,77,.20), transparent 60%),
        radial-gradient(400px 120px at 80% 80%, rgba(58,160,255,.18), transparent 60%),
        rgba(255,255,255,.06);
      border-color: rgba(255,255,255,.22);
    }

    .itemName{
      font-size:14px;
      letter-spacing:.2px;
      font-weight:700;
      line-height:1.2;
    }
    .itemMeta{
      display:flex;
      align-items:center;
      gap:8px;
      flex-shrink:0;
    }
    .badge{
      font-size:11px;
      letter-spacing:.4px;
      padding:5px 8px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.06);
      color: rgba(242,242,247,.85);
      text-transform:uppercase;
    }
    .badge.full{
      border-color: rgba(44,255,154,.28);
      background: rgba(44,255,154,.10);
      color: rgba(205,255,232,.95);
    }
    .badge.todo{
      border-color: rgba(255,228,77,.25);
      background: rgba(255,228,77,.10);
      color: rgba(255,246,196,.95);
    }

    .detail{
      height:100%;
      overflow:auto;
      padding:18px 18px 22px;
    }

    .hero{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:12px;
      flex-wrap:wrap;
      padding-bottom:14px;
      border-bottom:1px solid rgba(255,255,255,.10);
      margin-bottom:14px;
    }
    .titleBlock{
      min-width:260px;
      max-width:760px;
    }
    .artistTitle{
      margin:0;
      font-size:30px;
      line-height:1.05;
      font-weight:900;
      letter-spacing:.4px;
      background: linear-gradient(90deg, var(--yellow), var(--red), var(--blue));
      -webkit-background-clip:text;
      background-clip:text;
      color:transparent;
    }
    .subline{
      margin-top:8px;
      font-size:13px;
      color:rgba(242,242,247,.78);
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
    }
    .dot{
      width:5px;height:5px;border-radius:50%;
      background: rgba(242,242,247,.35);
      display:inline-block;
    }

    .chipRow{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:flex-end;
      padding-top:4px;
    }
    .returnBtn{
      appearance:none;
      border:1px solid rgba(255,255,255,.16);
      background: rgba(0,0,0,.22);
      color: rgba(242,242,247,.90);
      border-radius: 999px;
      padding: 10px 12px;
      font-size: 12px;
      font-weight: 900;
      letter-spacing: .35px;
      cursor: pointer;
      transition: transform .12s ease, border-color .12s ease, background .12s ease;
    }
    .returnBtn:hover{transform: translateY(-1px); background: rgba(255,255,255,.06); border-color: rgba(255,255,255,.22);}
    .returnBtn:active{transform: translateY(0px);}

    .chip{
      font-size:12px;
      padding:8px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.22);
      color: rgba(242,242,247,.86);
    }
    .chip.red{border-color: rgba(255,53,94,.28); box-shadow: 0 12px 30px rgba(255,53,94,.12)}
    .chip.blue{border-color: rgba(58,160,255,.26); box-shadow: 0 12px 30px rgba(58,160,255,.12)}
    .chip.green{border-color: rgba(44,255,154,.24); box-shadow: 0 12px 30px rgba(44,255,154,.10)}
    .chip.yellow{border-color: rgba(255,228,77,.24); box-shadow: 0 12px 30px rgba(255,228,77,.10)}

    .bioBtn{
      appearance:none;
      border:1px solid rgba(255,255,255,.16);
      background: linear-gradient(180deg, rgba(255,228,77,.22), rgba(255,53,94,.14));
      color: rgba(242,242,247,.92);
      border-radius: 999px;
      padding: 8px 10px;
      font-size: 12px;
      font-weight: 900;
      letter-spacing: .35px;
      cursor: pointer;
      box-shadow: 0 12px 30px rgba(0,0,0,.25);
      transition: transform .12s ease, border-color .12s ease, background .12s ease;
      flex-shrink: 0;
    }
    .bioBtn:hover{transform: translateY(-1px); border-color: rgba(255,255,255,.24);}
    .bioBtn:active{transform: translateY(0px);}
    .bioBtn:focus{outline:none; box-shadow: 0 0 0 3px rgba(58,160,255,.25), 0 12px 30px rgba(0,0,0,.25);}


    .grid{
      grid-template-columns: 1fr;
      display: flex;
      flex-direction: column;
      gap: 12px;
      margin-top: 14px;
    }
    .card{
      border-radius:var(--radius);
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      padding:14px 14px 12px;
      min-height:0;
    }
    .card h3{
      margin:0 0 10px 0;
      font-size:13px;
      letter-spacing:.6px;
      text-transform:uppercase;
      color: rgba(242,242,247,.86);
      display:flex;
      align-items:center;
      gap:10px;
    }
    .accent{
      width:10px;height:10px;border-radius:3px;
      background: linear-gradient(135deg, var(--yellow), var(--red));
      box-shadow: 0 10px 20px rgba(255,53,94,.18);
      flex-shrink:0;
    }
    .card p{
      margin:0;
      color: rgba(242,242,247,.78);
      line-height:1.55;
      font-size:14px;
      white-space:pre-wrap;
    }
    ul{
      margin:0;
      padding-left:18px;
      color: rgba(242,242,247,.78);
      line-height:1.55;
      font-size:14px;
    }
    li{margin:6px 0}

    .links{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
    }
    a.link{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:10px 12px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.20);
      color: rgba(242,242,247,.90);
      text-decoration:none;
      font-size:13px;
      transition: transform .12s ease, border-color .12s ease, background .12s ease;
    }
    a.link:hover{
      transform: translateY(-1px);
      background: rgba(255,255,255,.06);
      border-color: rgba(255,255,255,.22);
    }
    .k{
      display:inline-block;
      width:10px;height:10px;border-radius:3px;
      background: var(--blue);
      box-shadow: 0 10px 20px rgba(58,160,255,.16);
    }

    .empty{
      padding:28px 18px;
      color: rgba(242,242,247,.80);
    }
    .empty h2{
      margin:0 0 8px 0;
      font-size:18px;
      letter-spacing:.4px;
    }
    .empty p{
      margin:0;
      color: rgba(242,242,247,.70);
      line-height:1.55;
    }

    .status{
      padding:10px 12px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.20);
      color: rgba(242,242,247,.78);
      font-size:13px;
      margin-top:10px;
      display:none;
    }
    .status.show{display:block}

    @media (max-width: 980px){
      body{overflow:auto}
      main{
        grid-template-columns: 1fr;
        height:auto;
      }
      .panel{min-height: 520px}
      input[type="search"]{width:min(640px, 70vw)}
    }
  
    .bioOverlay{
      position: fixed;
      inset: 0;
      z-index: 999;
      display: none;
      padding: 18px;
      background: rgba(0,0,0,.72);
      backdrop-filter: blur(10px);
    }
    .bioOverlay.show{ display: block; }
    .bioShell{
      height: 100%;
      max-width: 1200px;
      margin: 0 auto;
      border-radius: 26px;
      border: 1px solid rgba(255,255,255,.12);
      box-shadow: 0 28px 100px rgba(0,0,0,.70);
      overflow: hidden;
      background:
        radial-gradient(1000px 600px at 18% 12%, rgba(58,160,255,.14), transparent 60%),
        radial-gradient(900px 520px at 82% 16%, rgba(255,228,77,.12), transparent 62%),
        radial-gradient(900px 520px at 70% 82%, rgba(44,255,154,.10), transparent 60%),
        radial-gradient(900px 520px at 20% 84%, rgba(255,53,94,.12), transparent 62%),
        linear-gradient(180deg, #07070a, #101018);
    }
    .bioHeader{
      position: sticky;
      top: 0;
      z-index: 5;
      padding: 16px 16px 12px;
      display:flex;
      align-items:flex-start;
      justify-content: space-between;
      gap: 12px;
      border-bottom: 1px solid rgba(255,255,255,.10);
      background: linear-gradient(180deg, rgba(0,0,0,.50), rgba(0,0,0,.18));
      backdrop-filter: blur(10px);
    }
    .bioTitle{
      font-size: 26px;
      font-weight: 900;
      letter-spacing: .6px;
      line-height: 1.1;
      background: linear-gradient(90deg, var(--yellow), var(--red), var(--blue), var(--green));
      -webkit-background-clip:text;
      background-clip:text;
      color: transparent;
      text-shadow: 0 6px 30px rgba(0,0,0,.45);
    }
    .bioSub{ margin-top: 6px; font-size: 13px; color: rgba(242,242,247,.72); }
    .bioBody{
      height: calc(100% - 72px);
      overflow: auto;
      padding: 16px;
    }
    .bioHero{
      border-radius: 24px;
      border: 1px solid rgba(255,255,255,.12);
      background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.05));
      box-shadow: 0 18px 60px rgba(0,0,0,.45);
      padding: 16px;
      margin-bottom: 12px;
    }
    .bioHero h2{
      margin:0;
      font-size: 22px;
      font-weight: 900;
      letter-spacing: .3px;
    }
    .bioHero p{
      margin: 10px 0 0;
      color: rgba(242,242,247,.78);
      line-height: 1.55;
      white-space: pre-wrap;
    }
    .bioGrid{
      display:flex;
      flex-direction: column;
      gap: 12px;
      margin-top: 12px;
    }
    .bioCard{
      border-radius: var(--radius);
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      padding: 14px 14px 12px;
    }
    .bioCard h3{
      margin: 0 0 10px;
      font-size: 14px;
      letter-spacing: .6px;
      text-transform: uppercase;
      color: rgba(242,242,247,.78);
    }
    .bioCard .accent{
      display:inline-block;
      width:10px;
      height:10px;
      border-radius:999px;
      margin-right:10px;
      background: linear-gradient(135deg,var(--yellow),var(--red),var(--blue),var(--green));
      box-shadow: 0 10px 28px rgba(0,0,0,.35);
      vertical-align: middle;
    }
</style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="top">
        <div class="brand">
          <div class="logo" aria-hidden="true"></div>
          <div>
            <h1>Classic Rock Artists</h1>
            <div class="tag">Browse the library â€¢ click an artist to view details</div>
          </div>
        </div>

        <div class="controls">
          <div class="pill" title="Search artists">
            <span style="color:rgba(242,242,247,.75);font-size:14px">ðŸ”Ž</span>
            <input id="search" type="search" placeholder="Search artistsâ€¦" autocomplete="off" />
          </div>

          <div class="pill">
            <span style="color:rgba(242,242,247,.75);font-size:13px">Sort</span>
            <div class="selectWrap">
              <select id="sort">
                <option value="az">A â†’ Z</option>
                <option value="za">Z â†’ A</option>
                <option value="full">Filled first</option>
              </select>
            </div>
          </div>
        </div>
      </div>
    </header>

    <main>
      <section class="panel" aria-label="Artist list">
        <div class="listHeader">
          <div class="count" id="count">Loadingâ€¦</div>
          <div class="spark" aria-hidden="true">
            <div class="bar"></div><div class="bar"></div><div class="bar"></div><div class="bar"></div>
          </div>
        </div>
        <div class="list" id="list"></div>
      </section>

      <section class="panel" aria-label="Artist details">
        <div class="detail" id="detail">
          <div class="empty">
            <h2>Pick an artist</h2>
            <p>This page reads <b>Artists.json</b>. Right now only the first two artists are fully filled. The rest are name-only placeholders.</p>
            <div class="status" id="status"></div>
          </div>
        </div>
      </section>
    </main>
  </div>

  <script>
    const state = {
      raw: null,
      artists: [],
      filtered: [],
      selectedId: null,
      bios: null
    };

    const el = {
      list: document.getElementById("list"),
      detail: document.getElementById("detail"),
      count: document.getElementById("count"),
      search: document.getElementById("search"),
      sort: document.getElementById("sort"),
      status: document.getElementById("status")
    };

    const safe = (v) => (v == null ? "" : String(v));

    const slugify = (s) => safe(s)
      .toLowerCase()
      .replace(/&/g, "and")
      .replace(/[^a-z0-9]+/g, "-")
      .replace(/^-+|-+$/g, "");

    const escapeHtmlAttr = (s) => safe(s)
      .replace(/&/g, "&amp;")
      .replace(/</g, "&lt;")
      .replace(/>/g, "&gt;")
      .replace(/"/g, "&quot;")
      .replace(/\x27/g, "&#039;");


    const normKey = (s) => safe(s)
      .toLowerCase()
      .trim()
      .replace(/\s+/g, " ")
      .replace(/[â€™â€˜]/g, "'")
      .replace(/[â€œâ€]/g, '"');

    const repairJsonText = (text) => {
      let t = String(text || "");
      t = t.replace(/^[^\[{]*/s, "");
      t = t.replace(/\uFEFF/g, "");
      t = t.replace(/,\s*(\]|\})/g, "$1");
      return t.trim();
    };

    const loadBios = async () => {
      if (state.bios) return state.bios;
      const res = await fetch(BIOS_URL, { cache: "no-store" });
      if (!res.ok) throw new Error("HTTP " + res.status);
      const text = await res.text();
      let json;
      try { json = JSON.parse(text); } catch (e) { json = JSON.parse(repairJsonText(text)); }
      const list = Array.isArray(json) ? json : (Array.isArray(json.Biographies) ? json.Biographies : []);
      state.bios = list;
      return list;
    };


    const escapeHtml = (s) => safe(s)
      .replace(/&/g, "&amp;")
      .replace(/</g, "&lt;")
      .replace(/>/g, "&gt;")
      .replace(/"/g, "&quot;")
      .replace(/'/g, "&#039;");

    const isFilled = (a) => a && (a.Overview || a.NotableAlbums || a.Genres || a.YearsActive || a.ExternalLinks);

    const sortArtists = (arr) => {
      const mode = el.sort.value;
      const copy = [...arr];
      if (mode === "az") copy.sort((a,b)=>safe(a.Name).localeCompare(safe(b.Name)));
      if (mode === "za") copy.sort((a,b)=>safe(b.Name).localeCompare(safe(a.Name)));
      if (mode === "full") copy.sort((a,b)=>(isFilled(b) - isFilled(a)) || safe(a.Name).localeCompare(safe(b.Name)));
      return copy;
    };

    const matches = (a, q) => {
      if (!q) return true;
      const s = q.toLowerCase().trim();
      if (!s) return true;
      const fields = [
        a.Name,
        a.Type,
        a.Origin?.City,
        a.Origin?.Region,
        a.Origin?.Country,
        ...(a.Genres || [])
      ].filter(Boolean).join(" â€¢ ").toLowerCase();
      return fields.includes(s);
    };

    const badgeHTML = (a) => {
      const filled = isFilled(a);
      const cls = filled ? "badge full" : "badge todo";
      const txt = filled ? "FULL" : "TODO";
      return `<span class="${cls}">${txt}</span>`;
    };

    const itemHTML = (a) => {
      const name = safe(a.Name);
      const id = safe(a.ArtistID) || name;
      const active = state.selectedId === id ? "active" : "";
      return `
        <div class="item ${active}" role="button" tabindex="0" data-id="${id}">
          <div>
            <div class="itemName">${name}</div>
          </div>
          <div class="itemMeta">
            ${badgeHTML(a)}
          </div>
        </div>
      `;
    };

    const setCount = () => {
      const total = state.artists.length;
      const shown = state.filtered.length;
      const filled = state.artists.filter(isFilled).length;
      el.count.textContent = `${shown} shown â€¢ ${total} total â€¢ ${filled} filled`;
    };

    const renderList = () => {
      const q = safe(el.search.value);
      const filtered = state.artists.filter(a => matches(a, q));
      state.filtered = sortArtists(filtered);
      setCount();
      el.list.innerHTML = state.filtered.map(itemHTML).join("");
    };

    const chips = (a) => {
      const out = [];
      if (a.Type) out.push(`<span class="chip red">${safe(a.Type)}</span>`);
      const origin = [a.Origin?.City, a.Origin?.Region, a.Origin?.Country].filter(Boolean).join(", ");
      if (origin) out.push(`<span class="chip blue">${origin}</span>`);
      if (a.YearsActive && a.YearsActive.length) out.push(`<span class="chip yellow">${safe(a.YearsActive.join(", "))}</span>`);
      if (a.Genres && a.Genres.length) out.push(`<span class="chip green">${safe(a.Genres.slice(0,3).join(" â€¢ "))}${a.Genres.length>3?"â€¦":""}</span>`);
      const coreN = (a.CoreMembers && a.CoreMembers.length) ? a.CoreMembers.length : 0;
      const nonCoreN = (a.NonCoreMembers && a.NonCoreMembers.length) ? a.NonCoreMembers.length : 0;
      if (coreN || nonCoreN) out.push(`<span class="chip blue">${coreN} core â€¢ ${nonCoreN} non-core</span>`);
      return out.join("");
    };

    const listOrEmpty = (arr) => {
      if (!arr || !arr.length) return `<p>â€”</p>`;
      return `<ul>${arr.map(x=>`<li>${safe(x)}</li>`).join("")}</ul>`;
    };

    const albumsHTML = (albums) => {
      if (!albums || !albums.length) return `<p>â€”</p>`;
      return `<ul>${albums.map(a=>`<li><b>${safe(a.Title)}</b> (${safe(a.Year)})${a.Notes?` â€” ${safe(a.Notes)}`:""}</li>`).join("")}</ul>`;
    };

    const membersHTML = (members, isCore) => {
      if (!members || !members.length) return `<p>â€”</p>`;
      return `
        <div style="display:flex;flex-direction:column;gap:10px;">
          ${members.map(m=>{
            const name = safe(m.Name);
            const years = m.Years ? safe(m.Years) : "";
            const roles = (m.Roles && m.Roles.length) ? m.Roles.join(", ") : "";
            const instruments = (m.Instruments && m.Instruments.length) ? m.Instruments.join(", ") : "";
            const albums = (m.Albums && m.Albums.length) ? m.Albums : [];
            const replacing = (m.Replacing && m.Replacing.length) ? m.Replacing.join(", ") : "";
            const replacedBy = (m.ReplacedBy && m.ReplacedBy.length) ? m.ReplacedBy.join(", ") : "";
            const overview = m.Overview ? safe(m.Overview) : "";
            const row = (label, value) => value ? `<div style="margin-top:6px;"><span style="color:rgba(242,242,247,.65);font-size:12px;letter-spacing:.4px;text-transform:uppercase;">${label}</span><div style="margin-top:4px;color:rgba(242,242,247,.80);font-size:14px;line-height:1.5;">${value}</div></div>` : "";
            const albumsHtml = albums.length ? `<ul style="margin:6px 0 0 18px;">${albums.map(a=>`<li>${safe(a)}</li>`).join("")}</ul>` : "";
            return `
              <div style="border:1px solid rgba(255,255,255,.10);background:rgba(0,0,0,.18);border-radius:14px;padding:10px 12px;">
                <div style="display:flex;flex-wrap:wrap;align-items:center;gap:10px;justify-content:space-between;">
                  <div style="display:flex;flex-wrap:wrap;align-items:center;gap:10px;">
                    <div style="font-weight:800;letter-spacing:.2px;">${name}</div>
                    ${years ? `<span class="badge" style="opacity:.9;">${years}</span>` : ``}
                  </div>
                  ${isCore ? `<button class="bioBtn" data-member="${escapeHtmlAttr(name)}">Biography</button>` : ``}
                </div>
                ${roles ? `<div style="margin-top:6px;color:rgba(242,242,247,.80);font-size:14px;line-height:1.5;"><span style="color:rgba(242,242,247,.65);font-size:12px;letter-spacing:.4px;text-transform:uppercase;">Roles</span><div style="margin-top:4px;">${safe(roles)}</div></div>` : ``}
                ${instruments ? `<div style="margin-top:6px;color:rgba(242,242,247,.80);font-size:14px;line-height:1.5;"><span style="color:rgba(242,242,247,.65);font-size:12px;letter-spacing:.4px;text-transform:uppercase;">Instruments</span><div style="margin-top:4px;">${safe(instruments)}</div></div>` : ``}
                ${albums.length ? `<div style="margin-top:6px;color:rgba(242,242,247,.80);font-size:14px;line-height:1.5;"><span style="color:rgba(242,242,247,.65);font-size:12px;letter-spacing:.4px;text-transform:uppercase;">Albums<\/span>${albumsHtml}<\/div>` : ``}
                ${replacing ? `<div style="margin-top:6px;color:rgba(242,242,247,.80);font-size:14px;line-height:1.5;"><span style="color:rgba(242,242,247,.65);font-size:12px;letter-spacing:.4px;text-transform:uppercase;">Replacing</span><div style="margin-top:4px;">${safe(replacing)}</div></div>` : ``}
                ${replacedBy ? `<div style="margin-top:6px;color:rgba(242,242,247,.80);font-size:14px;line-height:1.5;"><span style="color:rgba(242,242,247,.65);font-size:12px;letter-spacing:.4px;text-transform:uppercase;">Replaced By</span><div style="margin-top:4px;">${safe(replacedBy)}</div></div>` : ``}
                ${overview ? `<div style="margin-top:8px;color:rgba(242,242,247,.78);font-size:14px;line-height:1.55;white-space:pre-wrap;">${safe(overview)}</div>` : ``}
              </div>
            `;
          }).join("")}
        </div>
      `;
    };

    const linksHTML = (links) => {
      if (!links) return `<p>â€”</p>`;
      const items = Object.entries(links).filter(([,v]) => !!v);
      if (!items.length) return `<p>â€”</p>`;
      return `<div class="links">${items.map(([k,v])=>`<a class="link" href="${safe(v)}" target="_blank" rel="noopener"><span class="k"></span>${safe(k)}</a>`).join("")}</div>`;
    };

    const detailHTML = (a) => {
      const name = safe(a.Name);
      const subBits = [];
      const origin = [a.Origin?.City, a.Origin?.Region, a.Origin?.Country].filter(Boolean).join(", ");
      if (origin) subBits.push(origin);
      if (a.Type) subBits.push(a.Type);
      if (a.YearsActive && a.YearsActive.length) subBits.push(a.YearsActive.join(", "));
      const sub = subBits.length ? subBits.join("  ") : "â€”";
      const filled = isFilled(a);

      if (!filled){
        return `
          <div class="hero">
            <div class="titleBlock">
              <h2 class="artistTitle">${name}</h2>
              <div class="subline"><span>${sub}</span></div>
            </div>
            <div class="chipRow"><button class="returnBtn" id="returnToList">Return</button>${chips(a)}</div>
          </div>

          <div class="card">
            <h3><span class="accent"></span>Details</h3>
            <p>This entry is a placeholder right now.</p>
          </div>
        `;
      }

      return `
        <div class="hero">
          <div class="titleBlock">
            <h2 class="artistTitle">${name}</h2>
            <div class="subline">
              <span>${sub}</span>
              <span class="dot"></span>
              <span>${badgeHTML(a)}</span>
            </div>
          </div>
          <div class="chipRow"><button class="returnBtn" id="returnToList">Return</button>${chips(a)}</div>
        </div>

        <div class="grid">
          <div class="card full">
            <h3><span class="accent"></span>Overview</h3>
            <p>${Array.isArray(a.Overview) ? safe(a.Overview.join("\n\n")) : safe(a.Overview)}</p>
          </div>
          <div class="card full">
            <h3><span class="accent"></span>Profile</h3>
            <ul>
              <li><b>Type:</b> ${a.Type ? safe(a.Type) : "â€”"}</li>
              <li><b>Origin:</b> ${[a.Origin?.City, a.Origin?.Region, a.Origin?.Country].filter(Boolean).join(", ") || "â€”"}</li>
              <li><b>Years Active:</b> ${(a.YearsActive && a.YearsActive.length) ? safe(a.YearsActive.join(", ")) : "â€”"}</li>
              <li><b>Genres:</b> ${(a.Genres && a.Genres.length) ? safe(a.Genres.join(", ")) : "â€”"}</li>
              <li><b>Labels:</b> ${(a.Labels && a.Labels.length) ? safe(a.Labels.join(", ")) : "â€”"}</li>
            </ul>
          </div>


          <div class="card">
            <h3><span class="accent"></span>Key Facts</h3>
            ${listOrEmpty(a.KeyFacts)}
          </div>

          <div class="card">
            <h3><span class="accent"></span>Core Members</h3>
            ${membersHTML(a.CoreMembers, true)}
          </div>

          <div class="card">
            <h3><span class="accent"></span>Non-Core Members</h3>
            ${membersHTML(a.NonCoreMembers, false)}
          </div>

          <div class="card">
            <h3><span class="accent"></span>Notable Albums</h3>
            ${albumsHTML(a.NotableAlbums)}
          </div>

          <div class="card">
            <h3><span class="accent"></span>Signature Songs</h3>
            ${listOrEmpty(a.SignatureSongs)}
          </div>

          <div class="card full">
            <h3><span class="accent"></span>Achievements</h3>
            ${a.Achievements && a.Achievements.length
              ? `<ul>${a.Achievements.map(x=>`<li><b>${safe(x.Type)}</b>${x.Year?` (${safe(x.Year)})`:""} â€” ${safe(x.Detail)}</li>`).join("")}</ul>`
              : `<p>â€”</p>`
            }
          </div>

          <div class="card full">
            <h3><span class="accent"></span>Links</h3>
            ${linksHTML(a.ExternalLinks)}
          </div>
        </div>
      `;
    };

    const selectArtist = (id) => {
      state.selectedId = id;
      renderList();
      const a = state.artists.find(x => (safe(x.ArtistID) || safe(x.Name)) === id);
      if (!a) return;
      el.detail.scrollTop = 0;
      el.detail.innerHTML = detailHTML(a);
    };



    const openBiography = (artist, memberName) => {
      const artistKey = safe(artist.ArtistID) ? safe(artist.ArtistID) : slugify(artist.Name);
      state.bio = {
        artistId: artistKey,
        artistName: safe(artist.Name),
        memberName: safe(memberName).trim()
      };
      showBioPage();
    };

    const clearSelection = () => {
      state.selectedId = null;
      renderList();
      el.detail.scrollTop = 0;
      el.detail.innerHTML = `
        <div class="empty">
          <h2>Pick an artist</h2>
          <p>This page reads <b>Artists.json</b>. Right now only the first two artists are fully filled. The rest are name-only placeholders.</p>
          <div class="status" id="status"></div>
        </div>
      `;
    };



    const wireListClicks = () => {
      el.list.addEventListener("click", (e) => {
        const item = e.target.closest(".item");
        if (!item) return;
        selectArtist(item.dataset.id);
      });
      el.list.addEventListener("keydown", (e) => {
        if (e.key !== "Enter" && e.key !== " ") return;
        const item = e.target.closest(".item");
        if (!item) return;
        e.preventDefault();
        selectArtist(item.dataset.id);
      });
    };

    const wireDetailClicks = () => {
      el.detail.addEventListener("click", (e) => {
        const ret = e.target.closest("#returnToList");
        if (ret) { clearSelection(); return; }

        const btn = e.target.closest(".bioBtn");
        if (!btn) return;
        const memberName = btn.getAttribute("data-member");
        const a = state.artists.find(x => (safe(x.ArtistID) || safe(x.Name)) === state.selectedId);
        if (!a) return;
        openBiography(a, memberName);
      });
    };


    const renderBioPage = async () => {
      const overlay = document.getElementById("bioOverlay");
      const body = document.getElementById("bioBody");
      const artistName = safe(state.bio.artistName);
      const memberName = safe(state.bio.memberName);
      const artistId = safe(state.bio.artistId);

      const chips = `
        <div class="chipRow" style="margin-top:12px;">
          ${artistName ? `<span class="chip blue">${safe(artistName)}</span>` : ``}
          ${memberName ? `<span class="chip yellow">${safe(memberName)}</span>` : ``}
        </div>
      `;

      body.innerHTML = `
        <div class="bioHero">
          <h2>${memberName || "Biography"}</h2>
          <p>Loadingâ€¦</p>
          ${chips}
        </div>
      `;

      let bio = null;
      let errorMsg = "";
      try {
        const bios = await loadBios();
        const pick = bios.find(b => normKey(b.ArtistID) === normKey(artistId) && normKey(b.MemberName) === normKey(memberName));
        if (pick) bio = pick;
        if (!bio) {
          const pick2 = bios.find(b => normKey(b.ArtistName) === normKey(artistName) && normKey(b.MemberName) === normKey(memberName));
          if (pick2) bio = pick2;
        }
      } catch (e) {
        errorMsg = safe(e && (e.message || e));
      }

      const bioText = bio && Array.isArray(bio.Biography)
        ? bio.Biography.map(safe).filter(Boolean).join("\n\n")
        : (bio && bio.Biography ? safe(bio.Biography) : "");

      const lookupInfo = (!bio)
        ? `Lookup key: ArtistID="${escapeHtml(artistId)}" â€¢ MemberName="${escapeHtml(memberName)}"`
        : "";

      const birth = bio && bio.Birth ? bio.Birth : null;
      const death = bio && bio.Death ? bio.Death : null;

      const birthLine = birth ? [safe(birth.Date), safe(birth.City), safe(birth.Region), safe(birth.Country)].filter(Boolean).join(" â€¢ ") : "";
      const deathLine = death ? [safe(death.Date), safe(death.City), safe(death.Region), safe(death.Country)].filter(Boolean).join(" â€¢ ") : "";

      const years = bio && Array.isArray(bio.ActiveYears) ? bio.ActiveYears.map(safe).filter(Boolean) : [];
      const acts = bio && Array.isArray(bio.AssociatedActs) ? bio.AssociatedActs.map(safe).filter(Boolean) : [];
      const albums = bio && Array.isArray(bio.KeyAlbums) ? bio.KeyAlbums : [];
      const songs = bio && Array.isArray(bio.KeySongs) ? bio.KeySongs.map(safe).filter(Boolean) : [];
      const ach = bio && Array.isArray(bio.Achievements) ? bio.Achievements : [];
      const links = bio && bio.ExternalLinks ? bio.ExternalLinks : null;

      const albumsHTML = albums.length
        ? `<ul style="margin:0;padding-left:18px;">${albums.map(a => {
            const t = safe(a.Title);
            const y = a.Year != null && a.Year !== "" ? safe(a.Year) : "";
            const n = safe(a.Notes);
            return `<li><b>${t}</b>${y ? ` (${y})` : ``}${n ? ` â€” ${n}` : ``}</li>`;
          }).join("")}</ul>`
        : `<div class="sub" style="margin:0;">â€”</div>`;

      const linksHTML = links
        ? Object.entries(links).filter(([k,v]) => safe(v).trim()).map(([k,v]) => {
            const url = safe(v);
            return `<a class="link" href="${url}" target="_blank" rel="noopener">${safe(k)}</a>`;
          }).join(" ")
        : "";

      const errCard = errorMsg
        ? `<div class="bioCard"><h3><span class="accent"></span>Error</h3><p style="margin:0;color:rgba(242,242,247,.78);">${escapeHtml(errorMsg)}</p></div>`
        : ``;

      body.innerHTML = `
        <div class="bioHero">
          <h2>${memberName || "Biography"}</h2>
          <p>${bioText ? escapeHtml(bioText) : (errorMsg ? "Couldnâ€™t load biographies." : ("No biography found." + (lookupInfo ? " " + lookupInfo : "")))}</p>
          ${chips}
        </div>

        <div class="bioGrid">
          <div class="bioCard">
            <h3><span class="accent"></span>Artist</h3>
            <p style="margin:0;color:rgba(242,242,247,.82);">${artistName || "â€”"}</p>
          </div>
          <div class="bioCard">
            <h3><span class="accent"></span>Birth</h3>
            <p style="margin:0;color:rgba(242,242,247,.78);">${birthLine || "â€”"}</p>
          </div>
          <div class="bioCard">
            <h3><span class="accent"></span>Death</h3>
            <p style="margin:0;color:rgba(242,242,247,.78);">${deathLine || "â€”"}</p>
          </div>
          <div class="bioCard">
            <h3><span class="accent"></span>Active Years</h3>
            <p style="margin:0;color:rgba(242,242,247,.78);">${years.length ? escapeHtml(years.join(", ")) : "â€”"}</p>
          </div>
          <div class="bioCard">
            <h3><span class="accent"></span>Associated Acts</h3>
            <p style="margin:0;color:rgba(242,242,247,.78);">${acts.length ? escapeHtml(acts.join(", ")) : "â€”"}</p>
          </div>
          <div class="bioCard">
            <h3><span class="accent"></span>Key Albums</h3>
            ${albumsHTML}
          </div>
          <div class="bioCard">
            <h3><span class="accent"></span>Key Songs</h3>
            <p style="margin:0;color:rgba(242,242,247,.78);">${songs.length ? escapeHtml(songs.join(", ")) : "â€”"}</p>
          </div>
          <div class="bioCard">
            <h3><span class="accent"></span>Achievements</h3>
            <ul style="margin:0;padding-left:18px;">${ach.length ? ach.map(x => `<li>${escapeHtml(safe(x.Type))}${x.Year ? ` (${escapeHtml(safe(x.Year))})` : ``}${x.Detail ? ` â€” ${escapeHtml(safe(x.Detail))}` : ``}</li>`).join("") : `<li>â€”</li>`}</ul>
          </div>
          <div class="bioCard">
            <h3><span class="accent"></span>Links</h3>
            <div style="display:flex;flex-wrap:wrap;gap:10px;">${linksHTML || `<span class="sub" style="margin:0;">â€”</span>`}</div>
          </div>
          ${errCard}
        </div>
      `;

      overlay.setAttribute("aria-hidden", "false");
    };

    const showBioPage = () => {
      const overlay = document.getElementById("bioOverlay");
      if (!overlay) return;
      overlay.classList.add("show");
      overlay.setAttribute("aria-hidden", "false");

      Promise.resolve(renderBioPage())
        .catch((e) => {
          const body = document.getElementById("bioBody");
          if (body) {
            const msg = safe(e && (e.message || e));
            body.innerHTML = `
              <div class="bioHero">
                <h2>Biography</h2>
                <p>Couldnâ€™t render biography.</p>
                <div class="chipRow" style="margin-top:12px;">
                  <span class="chip red">${escapeHtml(msg || "Unknown error")}</span>
                </div>
              </div>
            `;
          }
        });
    };

    const hideBioPage = () => {
      const overlay = document.getElementById("bioOverlay");
      overlay.classList.remove("show");
      overlay.setAttribute("aria-hidden", "true");
    };



    const showStatus = (msg) => {
      if (!el.status) return;
      el.status.textContent = msg;
      el.status.classList.add("show");
    };

    const init = async () => {
      try{
        const res = await fetch("https://raw.githubusercontent.com/BigBird7827/Rock-Music-Database/main/Artists.json", { cache: "no-store" });
        if (!res.ok) throw new Error(`HTTP ${res.status}`);
        const json = await res.json();
        state.raw = json;
        state.artists = Array.isArray(json) ? json : (Array.isArray(json.Artists) ? json.Artists : []);
        if (!state.artists.length) throw new Error("No artist objects found.");
        renderList();
        wireListClicks();
        wireDetailClicks();
        setCount();

        const firstFilled = state.artists.find(a => isFilled(a));
        if (firstFilled){
          selectArtist(safe(firstFilled.ArtistID) || safe(firstFilled.Name));
        } else {
          selectArtist(safe(state.artists[0].ArtistID) || safe(state.artists[0].Name));
        }
      } catch(err){
        el.count.textContent = "Failed to load Artists.json";
        el.list.innerHTML = "";
        showStatus("Couldnâ€™t load Artists.json. Put this HTML file in the same folder as Artists.json (or update the fetch path).");
      }
    };

    el.search.addEventListener("input", () => renderList());
    el.sort.addEventListener("change", () => renderList());

    init();

    window.addEventListener("DOMContentLoaded", () => {
      const btn = document.getElementById("bioReturnBtn");
      if (btn) {
        btn.addEventListener("click", () => {
          hideBioPage();
        });
      }
      const ov = document.getElementById("bioOverlay");
      if (ov) {
        ov.addEventListener("click", (e) => {
          if (e.target && e.target.id === "bioOverlay") hideBioPage();
        });
      }
    });
  </script>

  <div class="bioOverlay" id="bioOverlay" aria-hidden="true">
    <div class="bioShell">
      <div class="bioHeader">
        <div>
          <div class="bioTitle">Artist Biographies</div>
          
        </div>
        <button class="returnBtn" id="bioReturnBtn">Return</button>
      </div>
      <div class="bioBody" id="bioBody">
        <div class="empty">
          <h2>Artist Biographies</h2>
          <p>Select a core member to view biography details here.</p>
        </div>
      </div>
    </div>
  </div>

</body>
</html>
